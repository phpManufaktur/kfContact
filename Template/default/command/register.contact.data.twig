{#
  Contact

  @author Team phpManufaktur <team@phpmanufaktur.de>
  @link https://kit2.phpmanufaktur.de
  @copyright 2014 Ralf Hertsch <ralf.hertsch@phpmanufaktur.de>
  @license MIT License (MIT) http://www.opensource.org/licenses/MIT
#}

{% extends getTemplateFile('@phpManufaktur/Basic/Template', 'kitcommand/bootstrap/iframe.body.twig') %}
{% block title %}{{ 'Register a public contact record'|trans }}{% endblock %}
{% block description %}{{ 'Register a public contact record'|trans }}{% endblock %}
{% block stylesheet %}
  {{ parent() }}
  {% if form.contact_type.vars.value == 'PERSON' %}
    <link rel="stylesheet" type="text/css" href="{{ LIBRARY_URL }}/jquery/ui/latest/themes/smoothness/jquery-ui.min.css" />
  {% endif %}
  <link rel="stylesheet" type="text/css" href="{{ MANUFAKTUR_URL }}/Contact/Template/default/css/command.min.css" />
{% endblock %}  
{% block content %}
  <!-- {{ _self.getTemplateName() }} -->
  {# need the parent to enable prompting messages #}
  <h2>{{ 'Contact Type: %type%'|trans({'%type%':form.contact_type.vars.value|trans}) }}</h2>
  
  {{ parent() }}
  
  {# assign the bootstrap 3 theming for horizontal forms to the Symfony Form Factory output #}  
  {% form_theme form '@phpManufaktur/Contact/Template/default/command/form.fields.horizontal.twig' %}

  <form action="{{ FRAMEWORK_URL ~ '/contact/register/data/check?pid=' ~ basic.pid }}" class="form-horizontal" method="post" role="form">
    {# loop through all form fields from the form.json #}
    {{ form_widget(form) }}     

    <div class="form-group">
      <div class="col-sm-9 col-sm-offset-3">
        <button class="btn btn-default" type="submit">{{ 'Submit'|trans }}</button>
      </div>
    </div>
  </form>    
{% endblock %}
{% block footer_jquery %}
  {{ parent() }}
  {% if form.contact_type.vars.value == 'PERSON' %}
    <script type="text/javascript" src="{{ LIBRARY_URL }}/jquery/ui/latest/ui/minified/jquery-ui.min.js"></script>
    <script type="text/javascript" src="{{ LIBRARY_URL }}/jquery/ui/latest/ui/minified/i18n/jquery-ui-i18n.min.js"></script>
  {% endif %}
{% endblock footer_jquery %}
{% block footer %}
  {{ parent() }}
  <script type="text/javascript">
    if (typeof 'jQuery' !== 'undefined') {
      $(document).ready(function() {
        {% if form.contact_type.vars.value == 'PERSON' %}
          $.datepicker.setDefaults($.datepicker.regional['{{ app.translator.locale }}']);
          $('#form_person_birthday').datepicker({ 
            changeMonth: true,
            changeYear: true,
            minDate: '-100Y',
            maxDate: -1,
            yearRange: '{{ ('now'|date('Y'))-100 }}:{{ 'now'|date('Y') }}'
          });        
        {% endif %}
      });
    }
  </script>
{% endblock footer %}